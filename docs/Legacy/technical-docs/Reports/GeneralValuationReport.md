# üìÑ General Valuation Report Documentation

## üìÑ QUICK DOCUMENTATION
- **Template File**: N/A (Generated as Excel file)
- **Report Type**: Excel
- **Primary Purpose**: Provides comprehensive valuation details across multiple dimensions for all assets in a job
- **Key Data Sources**: AssetValuations, ComponentValuations, InsuranceValuations, MarketApproachValuations, IncomeApproachValuations
- **Who Uses This Report**: Valuers, Finance teams, Asset managers

## üìã DETAILED DOCUMENTATION

### üìä Overview
The General Valuation Report is a comprehensive Excel report that provides detailed valuation information for assets in multiple formats. It includes asset class summaries, asset-level details, component-level information, replacement cost data, insurance valuations, and approach-specific details (market and income). This report serves as the primary valuation output for financial reporting purposes.

### üîß Report Details
- **File Path**: /Application/Reports/Queries/GetGeneralValuationReport/GetGeneralValuationReportsQuery.cs
- **Generation Method**: Code-generated Excel file using IExcelFileBuilder service

### üìã Report Parameters
| Parameter | Type | Required | Default | Description |
|-----------|------|----------|---------|-------------|
| JobId | int | Yes | None | The ID of the job to generate the report for |
| AssetClass | string | No | "All" | Filter for a specific asset class or "All" |

### üîó Data Sources
- **Primary Data Sources**: 
  - AssetValuations
  - ComponentValuations
  - InsuranceValuations
  - MarketApproachValuations
  - IncomeApproachValuations
  - AssetReplacementCostValuations
  - ComponentReplacementCostValuations
- **Additional Data Sources**: 
  - Job
  - Client
  - Subscription

### üìä Report Sections
| Section Name | Description | Data Source | 
|--------------|-------------|-------------|
| Asset Class Report | Summary of valuation totals by asset class | AssetValuations grouped by AssetClass |
| Asset Level Report | Detailed valuation data for each asset | AssetValuations with basic fields |
| Component Level Report | Detailed valuation data for each component | ComponentValuations with all calculation details |
| Cost Apportionment Report | Replacement cost breakdowns for assets | AssetReplacementCostValuations |
| Cost Direct Cost Report | Replacement cost breakdowns for components | ComponentReplacementCostValuations |
| Insurance Valuation Report | Insurance values and parameters | InsuranceValuations |
| Contents Insurance Summary Report | Summary of contents values | Asset.Contents |
| Contents Insurance Detail Report | Detailed contents item listings | Asset.Contents |
| Market Approach Report | Market valuation details | MarketApproachValuations |
| Income Approach Report | Income valuation summaries | IncomeApproachValuations |
| Income Approach Items | Income valuation stream details | IncomeApproachItemValuations |

### üìÑ Output Format
The report is generated as an Excel workbook with multiple worksheets, each representing one of the sections listed above. Each worksheet contains formatted tabular data with appropriate column headers. The client logo is included in the report header.

### üìã Delivery Methods
- **Default Delivery**: Web download through ReportsController
- **Available Formats**: Excel (.xlsx)

### üìù Business Rules Applied
- Only controlled assets with appropriate valuation policies are included in valuation calculations
- Different reports are produced based on valuation type (cost, market, income)
- Insurance calculations include various factors (escalation, professional fees, debris removal)
- For market valuations, different calculation approaches are used based on the MarketApproach type
- For income valuations, detailed calculations are performed based on income streams
- Previous values are compared to current values to track changes

### üí° Usage Instructions
This report is generated by calling the GetGeneralValuationReports endpoint on the ReportsController. It can be filtered by asset class or generated for all asset classes. The report is downloaded as an Excel file.

### ‚ö° Performance Considerations
‚ÑπÔ∏è **Note:** This report can be resource-intensive for jobs with many assets. For very large jobs (10,000+ assets), consider:
- Generating the report during off-peak hours
- Using asset class filtering to generate separate reports
- Increasing the server timeout settings for report generation

### üìù Regulatory Compliance
The General Valuation Report is designed to support financial reporting requirements such as:
- IFRS/AASB 13: Fair Value Measurement
- IFRS/AASB 116: Property, Plant and Equipment
- Local government financial reporting regulations