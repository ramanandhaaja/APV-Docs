# üìÑ Methodology Report Documentation

## üìÑ QUICK DOCUMENTATION
- **Template Files**: "Methodology Report - Asset Class" and "Methodology Report - Asset Class Draft"
- **Report Type**: Word Document
- **Primary Purpose**: Documents the valuation methodology, assumptions, and parameters used for each asset class
- **Key Data Sources**: AssetAssumptions, ComponentAssumptions, ValuationProfiles, ValuationProfileScores
- **Who Uses This Report**: Valuers, Auditors, Finance teams, External reviewers

## üìã DETAILED DOCUMENTATION

### üìä Overview
The Methodology Report is a comprehensive Word document that details the valuation methodology, assumptions, and parameters used in the valuation process for a specific asset class. It serves as a key documentation element for audit purposes, providing transparency into how values were derived and which assumptions were applied. The report includes sections on unit rates, indices, valuation profiles, component assumptions, and special asset treatments.

### üîß Report Details
- **File Path**: /Application/Reports/Queries/GetMethodologyReport/GetMethodologyReportQuery.cs
- **Generation Method**: Word template-based using IDocumentBuilderService to replace content

### üìã Report Parameters
| Parameter | Type | Required | Default | Description |
|-----------|------|----------|---------|-------------|
| JobId | int | Yes | None | The ID of the job to generate the report for |
| AssetClass | string | No | "All" | Generate for a specific asset class or "All" |

### üîó Data Sources
- **Primary Data Sources**: 
  - AssetAssumptions
  - ComponentAssumptions
  - ValuationProfileRules
  - ValuationProfiles and ValuationProfileScores
  - InsuranceAssumptions
  - AssetValuations for summary data
- **Additional Data Sources**: 
  - Job
  - Client
  - Subscription

### üìä Report Sections
| Section Name | Description | Data Source | 
|--------------|-------------|-------------|
| Cover Page | Report title, entity, job info, and date | Job, Client information |
| Portfolio Summary | Overview of asset portfolio | AssetValuations summary |
| Valuation Class | Fair value measurement details | AssetValuations grouped by ValuationClass |
| Apportionment Unit Rates | Unit rates for apportionment approach | AssetReplacementCostValuations |
| Direct Cost Unit Rates | Unit rates for direct cost approach | ComponentReplacementCostValuations |
| Indices | Price indices used for adjustments | AssetAssumptions.Indices |
| Valuation Profiles | Summary of all valuation profiles used | ValuationProfileRules, ValuationProfiles |
| Valuation Profile Scores | Detailed consumption score mapping | ValuationProfileScores |
| Investment Valuations | Special handling for investment assets | Investment assets |
| Held for Sale Valuations | Special handling for held-for-sale assets | Held-for-sale assets |
| Highest and Best Use | Assets not at highest and best use | Assets where IsHighestAndBestUse = false |
| Component Assumptions | All component assumptions by type | ComponentAssumptions |
| Insurance Assumptions | Insurance valuation parameters | InsuranceAssumptions |

### üìÑ Output Format
The report is generated as a Word document (.docx) with professional formatting, tables, and structured sections. Draft reports include a "Draft" watermark. The client logo is included in the report header. A different template is used for IPSAS accounting standard clients.

### üìã Delivery Methods
- **Default Delivery**: Web download through ReportsController
- **Available Formats**: Word (.docx) for individual asset classes or ZIP archive of Word documents for "All"

### üìù Business Rules Applied
- Different report templates are used based on accounting standard (IFRS or IPSAS)
- The report title reflects the job status (draft/final)
- Valuation profiles are linked to specific asset types through ValuationProfileRules
- Only assumptions that have associated assets are included
- Special sections document non-standard valuation approaches (investment, held-for-sale)
- Assets not at highest and best use require valuer notes explaining why

### üí° Usage Instructions
This report is generated by calling the GetMethodologyReport endpoint on the ReportsController. It can be generated for a specific asset class or for all asset classes (resulting in a ZIP file with multiple reports). The report is downloaded as a Word document or ZIP archive.

### üîí Regulatory Compliance
The Methodology Report is a critical document for regulatory compliance with:

- IFRS 13/AASB 13: Fair Value Measurement disclosure requirements
- Audit evidence requirements for financial statement preparation
- International Valuation Standards (IVS) documentation requirements
- Public sector financial reporting standards

### üìù Customization Options
‚ÑπÔ∏è **Note:** The report template includes several customization options:

1. **Draft status**: Draft reports include a watermark and different header
2. **Accounting standard**: Different templates for IFRS and IPSAS clients
3. **Logo placement**: Client logo can be positioned in header or cover page
4. **Section inclusion**: Sections can be toggled based on report parameters